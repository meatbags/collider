var Collider=function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={system:{collisionCacheSize:10},quadrants:{size:{x:100,y:100,z:100}},plane:{dotBuffer:1e-4}};e.default=i},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.System=e.Mesh=void 0;var r=n(2),o=i(r),s=n(5),a=i(s);e.Mesh=o.default,e.System=a.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=(i(r),n(3)),s=i(o),a=function(t){if(this.isColliderMesh=!0,!t.isBufferGeometry)throw"Error: Input is not THREE.BufferGeometry";this.geometry=t,this.box=(new THREE.Box3).setFromBufferAttribute(t.attributes.position),this.min=this.box.min,this.max=this.box.max,this.planes=[],this.generatePlanes()};a.prototype={generatePlanes:function(){var t=this.geometry.attributes.position.array,e=this.geometry.attributes.normal.array;if(this.geometry.index)for(var n=this.geometry.index.array,i=this.geometry.attributes.position.itemSize,r=0;r<n.length;r+=3){var o=n[r]*i,a=n[r+1]*i,u=n[r+2]*i;this.planes.push(new s.default(new THREE.Vector3(t[o],t[o+1],t[o+2]),new THREE.Vector3(t[a],t[a+1],t[a+2]),new THREE.Vector3(t[u],t[u+1],t[u+2]),new THREE.Vector3(e[o],e[o+1],e[o+2]),new THREE.Vector3(e[a],e[a+1],e[a+2]),new THREE.Vector3(e[u],e[u+1],e[u+2])))}else for(var l=0;l<t.length;l+=9)this.planes.push(new s.default(new THREE.Vector3(t[l+0],t[l+1],t[l+2]),new THREE.Vector3(t[l+3],t[l+4],t[l+5]),new THREE.Vector3(t[l+6],t[l+7],t[l+8]),new THREE.Vector3(e[l+0],e[l+1],e[l+2]),new THREE.Vector3(e[l+3],e[l+4],e[l+5]),new THREE.Vector3(e[l+6],e[l+7],e[l+8])))},check:function(t){if(this.box.containsPoint(t)){for(var e=0;e<this.planes.length;e+=1)this.planes[e].culled=!1;for(var n=0;n<this.planes.length;n+=1)if(!this.planes[n].culled&&this.planes[n].isPointBelowOrEqual(t))for(var i=0;i<this.planes.length;i+=1)!this.planes[i].culled&&i!=n&&this.planes[n].isPlaneAbove(this.planes[i])&&(this.planes[i].culled=!0);for(var r=0;r<this.planes.length;r+=1)if(!this.planes[r].culled&&this.planes[r].isPointAboveOrEqual(t))return!1;return!0}return!1},getCeiling:function(t){for(var e=null,n=0;n<this.planes.length;n+=1){var i=this.planes[n];if((t.y<=i.p1.y||t.y<=i.p2.y||t.y<=i.p3.y)&&i.containsPointXZ(t)&&i.isPointBelowOrEqual(t)){var r=i.getY(t.x,t.z);(null===e||r<e)&&(e=r)}}return e}},e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),o=n(0),s=function(t){return t&&t.__esModule?t:{default:t}}(o),a=function(t,e,n,i,r,o){this.p1=t,this.p2=e,this.p3=n,this.n1=i,this.n2=r,this.n3=o,this.culled=!1,this.above=!1,this.below=!1,this.generatePlane()};a.prototype={generatePlane:function(){var t=r.subtractVector(this.p2,this.p1),e=r.subtractVector(this.p3,this.p1);this.normal=r.normalise(r.crossProduct(t,e)),r.dotProduct(this.normal,this.n1)<0&&(this.normal=r.reverseVector(this.normal)),this.position=new THREE.Vector3((this.p1.x+this.p2.x+this.p3.x)/3,(this.p1.y+this.p2.y+this.p3.y)/3,(this.p1.z+this.p2.z+this.p3.z)/3),this.D=-this.normal.x*this.position.x-this.normal.y*this.position.y-this.normal.z*this.position.z;var n=[this.p1,this.p2,this.p3];this.box=(new THREE.Box3).setFromPoints(n)},isPointAbove:function(t){var e=r.subtractVector(t,this.position);return r.dotProduct(e,this.normal)>0},isPointBelow:function(t){var e=r.subtractVector(t,this.position);return r.dotProduct(e,this.normal)<0},isPointAboveOrEqual:function(t){var e=r.subtractVector(t,this.position);return r.dotProduct(e,this.normal)>=-s.default.plane.dotBuffer},isPointBelowOrEqual:function(t){var e=r.subtractVector(t,this.position);return r.dotProduct(e,this.normal)<=s.default.plane.dotBuffer},isPlaneAbove:function(t){return this.isPointAboveOrEqual(t.p1)&&this.isPointAboveOrEqual(t.p2)&&this.isPointAboveOrEqual(t.p3)},containsPoint:function(t){return this.box.containsPoint(t)},containsPointXZ:function(t){return this.box.containsPoint(new THREE.Vector3(t.x,this.position.y,t.z))},getY:function(t,e){return(this.normal.x*t+this.normal.z*e+this.D)/-this.normal.y}},e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t,e){return new THREE.Vector3(t.x+e.x,t.y+e.y,t.z+e.z)},r=function(t,e){return new THREE.Vector3(t.x-e.x,t.y-e.y,t.z-e.z)},o=function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z);return 0==e?t:(t.x/=e,t.y/=e,t.z/=e,t)},s=function(t){return t.x*=-1,t.y*=-1,t.z*=-1,t},a=function(t,e){return new THREE.Vector3(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)},u=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z};e.dotProduct=u,e.addVector=i,e.subtractVector=r,e.crossProduct=a,e.reverseVector=s,e.normalise=o},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=i(r),s=n(6),a=i(s),u=function(){this.quadrants=new a.default,this.collisionCache=[],this.isColliderSystem=!0};u.prototype={add:function(){for(var t=0;t<arguments.length;t+=1){var e=arguments[t];if(!e.isColliderMesh)throw"Error: Input must be Collider.Mesh";this.quadrants.add(e)}},cache:function(t){this.collisionCache.unshift(t),this.collisionCache.length>o.default.system.collisionCacheSize&&this.collisionCache.splice(this.collisionCache.length-1,1)},flush:function(){this.collisionCache=[]},check:function(t){for(var e=this.quadrants.getQuadrant(t),n=!1,i=0;i<e.length;i+=1){var r=e[i];if(r.check(t)){n=!0,this.cache(r);break}}return n},getCeiling:function(t){for(var e=this.quadrants.getQuadrant(t),n=null,i=0;i<e.length;i+=1){var r=e[i];if(r.check(t)){var o=r.getCeiling(t);(null===n||o>n)&&(n=o)}}return n},getLastCollision:function(){return this.collisionCache.length>0?this.collisionCache[0]:null}},e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=function(t){return t&&t.__esModule?t:{default:t}}(i),o=function(){this.q=[]};o.prototype={positionToQuadrant:function(t){return{x:Math.floor(t.x/r.default.quadrants.size.x),y:Math.floor(t.y/r.default.quadrants.size.y),z:Math.floor(t.z/r.default.quadrants.size.z)}},add:function(t){for(var e=this.positionToQuadrant(t.min),n=this.positionToQuadrant(t.max),i=e.x;i<=n.x;i+=1)for(var r=e.y;r<=n.y;r+=1)for(var o=e.z;o<=n.z;o+=1)this.addToQuadrant(i,r,o,t)},addToQuadrant:function(t,e,n,i){this.q[t]||(this.q[t]=[]),this.q[t][e]||(this.q[t][e]=[]),this.q[t][e][n]||(this.q[t][e][n]=[]),this.q[t][e][n].push(i)},getQuadrant:function(t){var e=this.positionToQuadrant(t);return this.q[e.x]&&this.q[e.x][e.y]&&this.q[e.x][e.y][e.z]?this.q[e.x][e.y][e.z]:[]}},e.default=o}]);